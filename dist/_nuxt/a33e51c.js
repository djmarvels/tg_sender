(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{470:function(e,t,r){var content=r(472);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(50).default)("cac40fee",content,!0,{sourceMap:!1})},471:function(e,t,r){"use strict";r(470)},472:function(e,t,r){var n=r(49)(!1);n.push([e.i,".form-card[data-v-5d155358]{margin:48px 0}.form-card-image[data-v-5d155358]{width:300px;height:auto}",""]),e.exports=n},473:function(e,t,r){"use strict";r.r(t);r(12),r(48);var n=r(6);function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,m=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){m=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(m)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var c={name:"index",methods:{sendPost:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.uploadImage();case 3:return t.next=5,e.$axios.$post("http://localhost:3000/send",{text:e.botForm.text,link_text:e.botForm.link_text,link_href:e.botForm.link_href});case 5:e.$notify.success({title:"Успешно",message:"Пост опубликован"}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),400===t.t0.response.status?e.$notify.error({title:"Ошибка запроса",message:t.t0.response.data.message}):422===t.t0.response.status&&e.$notify.error({title:"Ошибка валидации",message:t.t0.response.data.message});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},uploadImage:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.botForm.image_file){t.next=27;break}return t.prev=1,t.next=4,e.$axios.$get("http://localhost:3000/chats");case 4:r=t.sent,n=o(r),t.prev=6,n.s();case 8:if((l=n.n()).done){t.next=14;break}return c=l.value,t.next=12,e.$axios.$post("https://api.telegram.org/bot1629253964:AAG3qQ9CHoYT-uiMX75PofKH3gi7xG44kLs/sendPhoto?chat_id=".concat(c),e.botForm.image_file,{headers:{"Content-Type":"multipart/form-data"}});case 12:t.next=8;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(6),n.e(t.t0);case 19:return t.prev=19,n.f(),t.finish(19);case 22:t.next=27;break;case 24:t.prev=24,t.t1=t.catch(1),console.log(t.t1);case 27:case"end":return t.stop()}}),t,null,[[1,24],[6,16,19,22]])})))()},emptyImage:function(){this.botForm.image=null,this.temp_image=null,this.botForm.image_file=null},changeImage:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$refs.photo_1.$refs.input.files[0],t.prev=1,t.next=4,e.toBase64(r);case 4:e.botForm.image=t.sent,(n=new FormData).append("photo",r),e.botForm.image_file=n,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()},toBase64:function(e){return new Promise((function(t,r){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return r(e)}}))}},data:function(){return{temp_image:"",botForm:{image:null,image_file:null,text:"",link_text:"",link_href:""}}}},m=(r(471),r(13)),component=Object(m.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-card"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-title"},[e._v("Заполнение данных")]),e._v(" "),r("el-form",{ref:"botForm",attrs:{model:e.botForm,"label-position":"top"}},[r("el-form-item",{attrs:{label:"Текст новости"}},[r("el-input",{attrs:{type:"textarea",placeholder:"Введите текст"},model:{value:e.botForm.text,callback:function(t){e.$set(e.botForm,"text",t)},expression:"botForm.text"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Фотография"}},[null==e.botForm.image?r("el-input",{ref:"photo_1",attrs:{type:"file",name:"photo_1"},on:{change:e.changeImage},model:{value:e.temp_image,callback:function(t){e.temp_image=t},expression:"temp_image"}}):e._e(),e._v(" "),null!=e.botForm.image?r("el-button",{attrs:{type:"primary"},on:{click:e.emptyImage}},[e._v("Обновить фотографию")]):e._e(),e._v(" "),null!=e.botForm.image?r("el-row",{style:{marginTop:"24px"}},[r("img",{staticClass:"form-card-image",attrs:{src:e.botForm.image,alt:""}})]):e._e()],1),e._v(" "),r("el-form-item",{attrs:{label:"Ссылка"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:12,sm:24}},[r("el-input",{attrs:{placeholder:"Введите текст ссылки"},model:{value:e.botForm.link_text,callback:function(t){e.$set(e.botForm,"link_text",t)},expression:"botForm.link_text"}})],1),e._v(" "),r("el-col",{attrs:{md:12,sm:24}},[r("el-input",{attrs:{placeholder:"Введите путь ссылки"},model:{value:e.botForm.link_href,callback:function(t){e.$set(e.botForm,"link_href",t)},expression:"botForm.link_href"}})],1)],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary","native-type":"button"},on:{click:e.sendPost}},[e._v("Отправить")])],1)],1)],1)])}),[],!1,null,"5d155358",null);t.default=component.exports}}]);